<launch>
    <arg name="gpu_device_id" default="0"/>
    <arg name="score_threshold" default="0.25"/>
    <arg name="nms_threshold" default="0.15"/>
<!--
    <arg name="network_definition_file" default="$(find vision_darknet_detect)/darknet/cfg/yolov7.cfg"/>
    <arg name="pretrained_model_file" default="$(find vision_darknet_detect)/darknet/data/yolov7.weights"/> -->
    <arg name="names_file" default="$(find vision_darknet_detect)/darknet/cfg/coco.names"/>
    
    <arg name="network_definition_file" default="$(env HOME)/.autoware/sjtu_data/perception_yolo7/darknet/cfg/yolov7.cfg"/>
    <arg name="pretrained_model_file" default="$(env HOME)/.autoware/sjtu_data/perception_yolo7/darknet/data/yolov7.weights"/>
    
    <arg name="camera_id" default="/"/>
    <arg name="image_src" default="/flir_adk/image_raw"/>
    <arg name="left_ignore_line" default="200" />
    <arg name="right_ignore_line" default="1720" />
    <arg name="bottom_emergency_line" default="1050" />

    <node pkg="vision_darknet_detect" name="vision_darknet_detect" type="vision_darknet_detect" output="screen">
        <param name="network_definition_file" type="str" value="$(arg network_definition_file)"/>
        <param name="pretrained_model_file" type="str" value="$(arg pretrained_model_file)"/>
        <param name="score_threshold" type="double" value="$(arg score_threshold)"/>
        <param name="nms_threshold" type="double" value="$(arg nms_threshold)"/>
        <param name="gpu_device_id" type="int" value="$(arg gpu_device_id)"/>
        <param name="image_raw_node" type="str" value="$(arg camera_id)$(arg image_src)"/>
        <param name="names_file" type="str" value="$(arg names_file)"/>
    </node>

    <node pkg="detected_objects_visualizer" type="visualize_rects" name="yolo7_rects"
          output="screen">
        <param name="image_src" value="$(arg image_src)"/>
        <param name="image_out" value="/image_rects"/>
        <param name="object_src" value="/detection/image_detector/objects"/> <!-- this is fixed by definition -->
        <param name="left_ignore_line" value="$(arg left_ignore_line)" />
        <param name="right_ignore_line" value="$(arg right_ignore_line)" />
        <param name="bottom_emergency_line" value="$(arg bottom_emergency_line)" />
    </node>

</launch>
